---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.0'
      jupytext_version: 0.8.6
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
# %autosave 0
```

```{python}
import numpy as np
import pandas as pd
import xarray as xr
import matplotlib.pyplot as plt
```

```{python}
ds = xr.open_dataset('data/low_sulfate_reduction_rate+/9_po75-25_di35e-9/water.nc')
growth_phy = ds['B_BIO_GrowthPhy'].to_dataframe()
growth_phy = growth_phy.loc['2011-01-01':'2011-12-31'].reset_index()
```

```{python}
foo, phy0 = growth_phy.groupby('z').get_group(growth_phy['z'][0]).sum()
foo, phy1 = growth_phy.groupby('z').get_group(growth_phy['z'][1]).sum()
foo, phy2 = growth_phy.groupby('z').get_group(growth_phy['z'][2]).sum()
foo, phy3 = growth_phy.groupby('z').get_group(growth_phy['z'][3]).sum()
```

```{python}
phy0 = phy0*0.05
phy1 = phy1*0.05
phy2 = phy2*1.25
phy3 = phy3*1.25
```

```{python}
phy = phy0+phy1+phy2+phy3
phy
```

```{python}
time_array = growth_phy.groupby('z').get_group(growth_phy['z'][3]).time.values
```

```{python}
B_BIO_GrowthPhy_array = growth_phy.groupby('z').get_group(growth_phy['z'][3]).B_BIO_GrowthPhy.values
```

```{python}
plt.style.use('classic')
fig = plt.figure(figsize=(14, 4))
ax = fig.add_subplot(1, 1, 1) # row-col-num
ax.plot(time_array, B_BIO_GrowthPhy_array, linewidth=2, label='Phytoplankton growth')
# --- add title and axis labels
ax.set_title('Primary production')
ax.set_ylabel('mg C m$^{-3}$ day$^{-3}$', fontsize=16)
ax.set_xlabel('Date', fontsize=16)
# --- plot a legend in the best location
ax.legend(loc='best')
# --- add grid â€“ not in default classic style
ax.grid(True)
# --- improve the layout
fig.tight_layout(pad=1)
```

```{python}

```
